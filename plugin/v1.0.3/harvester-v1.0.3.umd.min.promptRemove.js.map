{"version":3,"sources":["webpack://harvester-v1.0.3/./promptRemove/kubevirt.io.virtualmachine.vue?a66d","webpack://harvester-v1.0.3/promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-v1.0.3/./promptRemove/kubevirt.io.virtualmachine.vue?cde6","webpack://harvester-v1.0.3/./promptRemove/kubevirt.io.virtualmachine.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","t","type","domProps","resourceNames","names","plusMore","value","length","_l","removeNameArr","id","name","key","directives","rawName","expression","attrs","Array","isArray","checkedList","_i","on","$event","$$a","$$el","target","$$c","checked","$$v","$$i","concat","slice","checkAll","staticRenderFns","props","default","required","data","computed","forEach","crd","volume","persistentVolumeClaim","out","watch","handler","unshift","keys","deep","immediate","methods","remove","parentComponent","doneLocation","goTo","Promise","all","map","resource","removedDisks","replace","currentRouter","push","close","error","err","component"],"mappings":"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","file":"harvester-v1.0.3.umd.min.promptRemove.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mt-10\"},[_vm._v(\" \"+_vm._s(_vm.t('promptRemove.attemptingToRemove', {type: _vm.type}))+\" \"),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.resourceNames(_vm.names, _vm.plusMore, _vm.t))}}),_c('div',{staticClass:\"mt-10\"},[_vm._v(\" \"+_vm._s(_vm.t('harvester.virtualMachine.promptRemove.title'))+\" \")]),(_vm.value.length === 1)?_c('div',_vm._l((_vm.removeNameArr[_vm.value[0].id]),function(name){return _c('span',{key:name},[_c('label',{staticClass:\"checkbox-container mr-15\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.checkedList),expression:\"checkedList\"}],attrs:{\"type\":\"checkbox\",\"label\":name},domProps:{\"value\":name,\"checked\":Array.isArray(_vm.checkedList)?_vm._i(_vm.checkedList,name)>-1:(_vm.checkedList)},on:{\"change\":function($event){var $$a=_vm.checkedList,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=name,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.checkedList=$$a.concat([$$v]))}else{$$i>-1&&(_vm.checkedList=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.checkedList=$$c}}}}),_c('span',{staticClass:\"checkbox-custom mr-5\",attrs:{\"role\":\"checkbox\"}}),_vm._v(\" \"+_vm._s(name)+\" \")])])}),0):_c('div',[_c('label',{staticClass:\"checkbox-container mr-15\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.checkAll),expression:\"checkAll\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.checkAll)?_vm._i(_vm.checkAll,null)>-1:(_vm.checkAll)},on:{\"change\":function($event){var $$a=_vm.checkAll,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.checkAll=$$a.concat([$$v]))}else{$$i>-1&&(_vm.checkAll=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.checkAll=$$c}}}}),_c('span',{staticClass:\"checkbox-custom mr-5\",attrs:{\"role\":\"checkbox\"}}),_vm._v(\" \"+_vm._s(_vm.t('harvester.virtualMachine.promptRemove.deleteAll'))+\" \")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { HCI } from '../types';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:     Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    }\n  },\n\n  data() {\n    return {\n      checkedList: [],\n      checkAll:    true\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter(volume => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      const parentComponent = this.$parent.$parent.$parent;\n\n      let goTo;\n\n      if (parentComponent.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...parentComponent.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          parentComponent.currentRouter.push(goTo);\n        }\n        parentComponent.close();\n      }).catch((err) => {\n        parentComponent.error = err;\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    {{ t('promptRemove.attemptingToRemove', {type}) }}\n    <span v-html=\"resourceNames(names, plusMore, t)\"></span>\n\n    <div class=\"mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.title') }}\n    </div>\n    <div v-if=\"value.length === 1\">\n      <span v-for=\"name in removeNameArr[value[0].id]\" :key=\"name\">\n        <label class=\"checkbox-container mr-15\"><input v-model=\"checkedList\" type=\"checkbox\" :label=\"name\" :value=\"name\" />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ name }}\n        </label>\n      </span>\n    </div>\n\n    <div v-else>\n      <label class=\"checkbox-container mr-15\"><input v-model=\"checkAll\" type=\"checkbox\" />\n        <span\n          class=\"checkbox-custom mr-5\"\n          role=\"checkbox\"\n        />\n        {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n      </label>\n    </div>\n  </div>\n</template>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=2dd983c5&\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}