{"version":3,"sources":["webpack://harvester-v1.3.1/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-v1.3.1/promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-v1.3.1/./promptRemove/kubevirt.io.virtualmachine.vue?cde6","webpack://harvester-v1.3.1/./promptRemove/kubevirt.io.virtualmachine.vue?f89d"],"names":["render","_vm","this","_c","_self","staticClass","_v","_s","t","type","directives","name","rawName","value","resourceNames","names","plusMore","expression","length","_l","removeNameArr","id","key","checkedList","attrs","domProps","Array","isArray","_i","on","$event","$$a","$$el","target","$$c","checked","$$v","$$i","concat","slice","checkAll","staticRenderFns","props","default","String","required","data","computed","mapState","mapGetters","out","forEach","crd","_crd$spec$template$sp","HCI","VM","volumes","spec","template","filter","volume","persistentVolumeClaim","map","remaining","toRemove","count","watch","handler","neu","keys","Object","values","unshift","deep","immediate","methods","remove","parentComponent","$parent","goTo","doneLocation","Promise","all","resource","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","results","isEmpty","currentRouter","push","close","catch","err","error","component"],"mappings":"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","file":"harvester-v1.3.1.umd.min.promptRemove.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mt-10\"},[_vm._v(\" \"+_vm._s(_vm.t('promptRemove.attemptingToRemove', {type: _vm.type}))+\" \"),_c('span',{directives:[{name:\"clean-html\",rawName:\"v-clean-html\",value:(_vm.resourceNames(_vm.names, _vm.plusMore, _vm.t)),expression:\"resourceNames(names, plusMore, t)\"}]}),_c('div',{staticClass:\"mt-10\"},[_vm._v(\" \"+_vm._s(_vm.t('harvester.virtualMachine.promptRemove.title'))+\" \")]),(_vm.value.length === 1)?_c('div',_vm._l((_vm.removeNameArr[_vm.value[0].id]),function(name){return _c('span',{key:name},[_c('label',{staticClass:\"checkbox-container mr-15\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.checkedList),expression:\"checkedList\"}],attrs:{\"type\":\"checkbox\",\"label\":name},domProps:{\"value\":name,\"checked\":Array.isArray(_vm.checkedList)?_vm._i(_vm.checkedList,name)>-1:(_vm.checkedList)},on:{\"change\":function($event){var $$a=_vm.checkedList,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=name,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.checkedList=$$a.concat([$$v]))}else{$$i>-1&&(_vm.checkedList=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.checkedList=$$c}}}}),_c('span',{staticClass:\"checkbox-custom mr-5\",attrs:{\"role\":\"checkbox\"}}),_vm._v(\" \"+_vm._s(name)+\" \")])])}),0):_c('div',[_c('label',{staticClass:\"checkbox-container mr-15\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.checkAll),expression:\"checkAll\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.checkAll)?_vm._i(_vm.checkAll,null)>-1:(_vm.checkAll)},on:{\"change\":function($event){var $$a=_vm.checkAll,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.checkAll=$$a.concat([$$v]))}else{$$i>-1&&(_vm.checkAll=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.checkAll=$$c}}}}),_c('span',{staticClass:\"checkbox-custom mr-5\",attrs:{\"role\":\"checkbox\"}}),_vm._v(\" \"+_vm._s(_vm.t('harvester.virtualMachine.promptRemove.deleteAll'))+\" \")])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { HCI } from '../types';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    }\n  },\n\n  data() {\n    return {\n      checkedList: [],\n      checkAll:    true\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter(volume => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      const parentComponent = this.$parent.$parent.$parent;\n\n      let goTo;\n\n      if (parentComponent.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...parentComponent.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          parentComponent.currentRouter.push(goTo);\n        }\n        parentComponent.close();\n      }).catch((err) => {\n        parentComponent.error = err;\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    {{ t('promptRemove.attemptingToRemove', {type}) }}\n    <span v-clean-html=\"resourceNames(names, plusMore, t)\"></span>\n\n    <div class=\"mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.title') }}\n    </div>\n    <div v-if=\"value.length === 1\">\n      <span v-for=\"name in removeNameArr[value[0].id]\" :key=\"name\">\n        <label class=\"checkbox-container mr-15\"><input v-model=\"checkedList\" type=\"checkbox\" :label=\"name\" :value=\"name\" />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ name }}\n        </label>\n      </span>\n    </div>\n\n    <div v-else>\n      <label class=\"checkbox-container mr-15\"><input v-model=\"checkAll\" type=\"checkbox\" />\n        <span\n          class=\"checkbox-custom mr-5\"\n          role=\"checkbox\"\n        />\n        {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n      </label>\n    </div>\n  </div>\n</template>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=586e2709&\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}